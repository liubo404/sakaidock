Digital Earth and Life Space
</group/Digital-Earth-and-Life-Space?hl=en&lnk=> 	今夜我想你 [色情图片 -
Erotic Pictures] </group/EroticPics?hl=en&lnk=> *(207)*
Playful Young Ladies </group/Playful-Young-Ladies?hl=en&lnk=> *(2113)*
夫妻交友俱樂部 </group/sydneycouples?hl=en&lnk=> *(388)*
Sakai Kernel 	广东圣地 </group/gd_gzsd?hl=en&lnk=> *(309)*
Spiritual Body Works Of Indianapolis Indiana
</group/Spiritual-Body-Works-Of-Indianapolis-Indiana?hl=en&lnk=> *(388)* 	
成人美图 </group/meinvpic?hl=en&lnk=> *(790)*
中国性吧 </group/chinaxbar?hl=en&lnk=> *(5)* 	成人資訊網
</group/t3322stc?hl=en&lnk=> *(8047)*
乐不思蜀邮件列表 </group/ebusishu?hl=en&lnk=> *(42)* 	欢乐谷
</group/happycanyon?hl=en&lnk=> *(2880)*
*Recently visited*  [clear]
</groups/clearrecent?hl=en&Action.ClearRecent&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fhowto---write-a-webapp-with-k2%3Fhl%3Den>
adobe.svg </group/adobe.svg?hl=en&lnk=> 	mozilla.support.firefox
</group/mozilla.support.firefox?hl=en&lnk=>
Android Beginners </group/android-beginners?hl=en&lnk=> 	redsaga-notify
</group/redsaga-notify?hl=en&lnk=> *(7)*
Android Developers </group/android-developers?hl=en&lnk=> 	Spark View
Engine Dev </group/spark-dev?hl=en&lnk=>
blogger交流 </group/blogger2008?hl=en&lnk=> 	【乐不思蜀】会员俱乐部
</group/lebusishubbs?hl=en&lnk=>
comp.infosystems.gis </group/comp.infosystems.gis?hl=en&lnk=> 	夫妻交友
俱乐部【已验证】 </group/huan-qi?hl=en&lnk=>
Machine Learning News </group/ML-news?hl=en&lnk=> 	成人世界
</group/adultworld?hl=en&lnk=> *(12)*

Groups Alerts <http://www.google.com/alerts?t=8&hl=en> Groups Alerts
<http://www.google.com/alerts?t=8&hl=en>
*Create a group... </groups/create?hl=en&lnk=l>*
Google Groups Home </?hl=en>

	*bochuxt@gmail.com* | My Groups </?hl=en> | Favorites
</groups/favorites?hl=en> | Profile </groups/profile?hl=en&myprofile> |
Help </support?hl=en> | My Account
<https://www.google.com/accounts/ManageAccount?hl=en> | Sign out
</groups/signout?hl=en&q=1&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fhowto---write-a-webapp-with-k2%3Fhl%3Den>


	
Sakai Kernel </group/sakai-kernel?hl=en>
	
		

Home </group/sakai-kernel?hl=en>

Discussions </group/sakai-kernel/topics?hl=en>

Pages </group/sakai-kernel/web?hl=en>

+ add new page <#>

Files </group/sakai-kernel/files?hl=en>
About this group </group/sakai-kernel/about?hl=en>
Edit my membership </group/sakai-kernel/subscribe?hl=en>
		

*Group info*
*Members:* 61
*Activity:* Low activity
*Language:* English
*Group categories:* /Not categorized/
*More group info » </group/sakai-kernel/about?hl=en>*

		

*Recent pages and files*
AAA Index </group/sakai-kernel/web/aaa-index?hl=en> 	6:03am
Authorization </group/sakai-kernel/web/authorization?hl=en> 	6:02am
Relational Indexes & JCR
</group/sakai-kernel/web/relational-indexes-jcr?hl=en> 	6:01am
Authorization(2)_img_1.jpg
<http://sakai-kernel.googlegroups.com/web/Authorization(2)_img_1.jpg?hl=en&gda=R6yo4VAAAADrEswdrVWjD6FpUIyszRRb3vKDMXtt-PzrTAhbuveJHg2ab9AKaL_BUF4MZAySMa60srPT98LWj-81pTwX9GlubcVT3VtYGKLco-_l-8AzjQ>
	5:59am
relationindex2.png
<http://sakai-kernel.googlegroups.com/web/relationindex2.png?hl=en&gda=ct9YAkQAAADrEswdrVWjD6FpUIyszRRbRVI5kRKy5vsA7pbeTJb-jdikRep6wwpepv6EeIJJc6RV6u9SiETdg0Q2ffAyHU-dzc4BZkLnSFWX59nr5BxGqA>
	1:57am
miniHowTo - Write a Webapp with K2
</group/sakai-kernel/web/howto---write-a-webapp-with-k2?hl=en> 	1:22am
miniHOWTO Write a component in K2
</group/sakai-kernel/web/minihowto-write-a-component-in-k2?hl=en> 	Feb 3
K2 Classloader </group/sakai-kernel/web/k2-classloader?hl=en> 	Jan 23
K2-Classloaders.png
<http://sakai-kernel.googlegroups.com/web/K2-Classloaders.png?hl=en&gda=ykUoSEUAAADrEswdrVWjD6FpUIyszRRbBXec-1jQ2lxMgzyhowsImLI6UCvoiRMPT21xhY4w_itzlqnWZQD3y6jZqCMfSFQ6Gu1iLHeqhw4ZZRj3RjJ_-A>
	Jan 23
Technical Approach to "Everything is Content"
</group/sakai-kernel/web/technical-approach-to-everything-is-content?hl=en>
	Jan 23

		

miniHowTo - Write a Webapp with K2   	  Edit
</group/sakai-kernel/edit/howto---write-a-webapp-with-k2?hl=en>

		


    miniHOWTO Write a Webapp with K2


The good news is its simpler than it was with Sakai 2, you just write
your webapp, there are no restrictions on what you do or how you do it,
although you may want to consider using the content features of K2
rather than creating your own database structured to store content.
There are some things that you should do to ensure that your requests
follow some simple lifecycle rules. To make all of this easy, you will
need to ensure that a Servlet Request Filter is invoked before your
webapp servlets, so you need to have a web.xml something like the one below:

<?xml version="1.0"?>
<web-app id="SData" version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
  <display-name>portal</display-name>
  <description>Sakai SData</description>

<!-- instance the filter -->
  <filter>
    <filter-name>sakai.request</filter-name>
    <filter-class>org.sakaiproject.kernel.webapp.filter.SakaiRequestFilter</filter-class>
  </filter>

<!-- map the filter -->
  <filter-mapping>
    <filter-name>sakai.request</filter-name>
    <servlet-name>ControllerServlet</servlet-name>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>INCLUDE</dispatcher>
  </filter-mapping>

<!-- my servlets -->
  <servlet>
    <servlet-name>ControllerServlet</servlet-name>
    <servlet-class>org.sakaiproject.sdata.tool.ControllerServlet</servlet-class>
    <load-on-startup>100</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>ControllerServlet</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
  </welcome-file-list>
</web-app>



Here I instance a /SakaiRequestFilter/ and bind that onto my
/ControllerServlet. /The /SakaiRequestFilter/ is exported from the
kernel component so you don't have to bundle any jars with your webapp
to make this work.

That sounds all very well, but how do I get to the kernel services ?
Lets take the example of saving something to the JCR. To do this, I need
to get access to the JCR. The best way of doing this is to get hold of
the JCRNodeFactoryService. Here's how:

    // Get hold of a lightweight KernelManager object (overhead ~1ms)
    KernelManager kernelManager = new KernelManager();

    // Retrieve the JCRNodeFactoryService.
    JCRNodeFactoryService jcrNodeFactoryService =
kernelManager.getService(JCRNodeFactoryService.class);

        ...

    ByteArrayInputStream bais = null;
    try {
      bais = new ByteArrayInputStream("".getBytes(StringUtils.UTF8));

      // set the content of the body of the node
      Node n =
jcrNodeFactoryService.setInputStream("/my/file/location/text.txt", bais,
"text/plain");
      n.save();
    } finally {
      bais.close();
    }

The KernelManager class is relatively quick to instance and use, but in
a servlet environment you probably want to put that into a init() method
so you can grab the services at startup once only.

Thats it, there is nothing more thats required to build a webapp for
Kernel 2.


For more information on the services that Kernel2 exports have a look at
the Javadoc, http://www2.caret.cam.ac.uk/~ieb/kernel/apidocs/index.html
<http://www2.caret.cam.ac.uk/%7Eieb/kernel/apidocs/index.html> is
normally uptodate, for instance the SessionManagerService
http://www2.caret.cam.ac.uk/~ieb/kernel/apidocs/org/sakaiproject/kernel/api/session/SessionManagerService.html
<http://www2.caret.cam.ac.uk/%7Eieb/kernel/apidocs/org/sakaiproject/kernel/api/session/SessionManagerService.html>
will give you the current session, and the
UserEnvironmentResolverService
http://www2.caret.cam.ac.uk/~ieb/kernel/apidocs/org/sakaiproject/kernel/api/userenv/UserEnvironmentResolverService.html#resolve(org.sakaiproject.kernel.api.session.Session)
<http://www2.caret.cam.ac.uk/%7Eieb/kernel/apidocs/org/sakaiproject/kernel/api/userenv/UserEnvironmentResolverService.html#resolve%28org.sakaiproject.kernel.api.session.Session%29>
can be used to resolve the User  eg

    SessionManagerService sessionManagerService =
kernelManager.getService(SessionManagerService.class);
    UserEnvironmentResolverService userEnvironmentResolverService =
kernelManager.getService(UserEnvironmentResolverService.class);

    ...

    Session session = sessionManagerService.getCurrentSession();
    UserEnvironment userEnvironment =
userEnvironmentResolverService.resolve(session);


	Version: 

Page editing not supported in your web browser. Download a new copy of
Firefox <http://getfirefox.com> or Internet Explorer
<http://www.microsoft.com/windows/ie/downloads/> to edit pages.
*2 messages about this page *
*2:50am* by John Norman
Can I suggest that if anyone tries to work through these, they post
edits for problems they encounter to help those following in their
footsteps.

John

*Yesterday* by Ian Boston
I noticed that this was missing so I had a go a writing it. Hope it
makes sense, it does assume you know how to write a standard webapp.

Click on
http://groups.google.com/group/sakai-kernel/web/howto---write-a-webapp-with-k2

- or copy & paste it into your browser's address bar if that doesn't
work.

Report this page
</groups/abuse?hl=en&group=sakai-kernel&type=page&url=http%3A%2F%2Fgroups.google.com%2Fgroup%2Fsakai-kernel%2Fweb%2Fhowto---write-a-webapp-with-k2%3Fhl%3Den&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fhowto---write-a-webapp-with-k2%3Fhl%3Den%26&>

Reply to this discussion <#>
Hide message box <#>

	

*Create a group </groups/create?hl=en&lnk=gcf>* - Google Groups
</?hl=en> - Google Home <http://www.google.com/webhp?hl=en> - Terms of
Service
<http://groups.google.com/intl/en/googlegroups/terms_of_service3.html> -
Privacy Policy
<http://groups.google.com/intl/en/googlegroups/privacy3.html>
©2009 Google

