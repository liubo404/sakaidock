Digital Earth and Life Space
</group/Digital-Earth-and-Life-Space?hl=en&lnk=> 	今夜我想你 [色情图片 -
Erotic Pictures] </group/EroticPics?hl=en&lnk=> *(207)*
Playful Young Ladies </group/Playful-Young-Ladies?hl=en&lnk=> *(2113)*
夫妻交友俱樂部 </group/sydneycouples?hl=en&lnk=> *(388)*
Sakai Kernel 	广东圣地 </group/gd_gzsd?hl=en&lnk=> *(309)*
Spiritual Body Works Of Indianapolis Indiana
</group/Spiritual-Body-Works-Of-Indianapolis-Indiana?hl=en&lnk=> *(388)* 	
成人美图 </group/meinvpic?hl=en&lnk=> *(790)*
中国性吧 </group/chinaxbar?hl=en&lnk=> *(5)* 	成人資訊網
</group/t3322stc?hl=en&lnk=> *(8047)*
乐不思蜀邮件列表 </group/ebusishu?hl=en&lnk=> *(42)* 	欢乐谷
</group/happycanyon?hl=en&lnk=> *(2880)*
*Recently visited*  [clear]
</groups/clearrecent?hl=en&Action.ClearRecent&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fk2-deploying-to-tomcat%3Fhl%3Den>
adobe.svg </group/adobe.svg?hl=en&lnk=> 	mozilla.support.firefox
</group/mozilla.support.firefox?hl=en&lnk=>
Android Beginners </group/android-beginners?hl=en&lnk=> 	redsaga-notify
</group/redsaga-notify?hl=en&lnk=> *(7)*
Android Developers </group/android-developers?hl=en&lnk=> 	Spark View
Engine Dev </group/spark-dev?hl=en&lnk=>
blogger交流 </group/blogger2008?hl=en&lnk=> 	【乐不思蜀】会员俱乐部
</group/lebusishubbs?hl=en&lnk=>
comp.infosystems.gis </group/comp.infosystems.gis?hl=en&lnk=> 	夫妻交友
俱乐部【已验证】 </group/huan-qi?hl=en&lnk=>
Machine Learning News </group/ML-news?hl=en&lnk=> 	成人世界
</group/adultworld?hl=en&lnk=> *(12)*

Groups Alerts <http://www.google.com/alerts?t=8&hl=en> Groups Alerts
<http://www.google.com/alerts?t=8&hl=en>
*Create a group... </groups/create?hl=en&lnk=l>*
Google Groups Home </?hl=en>

	*bochuxt@gmail.com* | My Groups </?hl=en> | Favorites
</groups/favorites?hl=en> | Profile </groups/profile?hl=en&myprofile> |
Help </support?hl=en> | My Account
<https://www.google.com/accounts/ManageAccount?hl=en> | Sign out
</groups/signout?hl=en&q=1&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fk2-deploying-to-tomcat%3Fhl%3Den>


	
Sakai Kernel </group/sakai-kernel?hl=en>
	
		

Home </group/sakai-kernel?hl=en>

Discussions </group/sakai-kernel/topics?hl=en>

Pages </group/sakai-kernel/web?hl=en>

+ add new page <#>

Files </group/sakai-kernel/files?hl=en>
About this group </group/sakai-kernel/about?hl=en>
Edit my membership </group/sakai-kernel/subscribe?hl=en>
		

*Group info*
*Members:* 61
*Activity:* Low activity
*Language:* English
*Group categories:* /Not categorized/
*More group info » </group/sakai-kernel/about?hl=en>*

		

*Recent pages and files*
AAA Index </group/sakai-kernel/web/aaa-index?hl=en> 	6:03am
Authorization </group/sakai-kernel/web/authorization?hl=en> 	6:02am
Relational Indexes & JCR
</group/sakai-kernel/web/relational-indexes-jcr?hl=en> 	6:01am
Authorization(2)_img_1.jpg
<http://sakai-kernel.googlegroups.com/web/Authorization(2)_img_1.jpg?hl=en&gda=_vPnwlAAAADrEswdrVWjD6FpUIyszRRbw469u5BDAkU5PEAPW3uIBA2ab9AKaL_BUF4MZAySMa60srPT98LWj-81pTwX9GlubcVT3VtYGKLco-_l-8AzjQ>
	5:59am
relationindex2.png
<http://sakai-kernel.googlegroups.com/web/relationindex2.png?hl=en&gda=-nC2nEQAAADrEswdrVWjD6FpUIyszRRbqWfLdwbyeDdzY3KpL3Lc-NikRep6wwpepv6EeIJJc6RV6u9SiETdg0Q2ffAyHU-dzc4BZkLnSFWX59nr5BxGqA>
	1:57am
miniHowTo - Write a Webapp with K2
</group/sakai-kernel/web/howto---write-a-webapp-with-k2?hl=en> 	1:22am
miniHOWTO Write a component in K2
</group/sakai-kernel/web/minihowto-write-a-component-in-k2?hl=en> 	Feb 3
K2 Classloader </group/sakai-kernel/web/k2-classloader?hl=en> 	Jan 23
K2-Classloaders.png
<http://sakai-kernel.googlegroups.com/web/K2-Classloaders.png?hl=en&gda=2vs7kUUAAADrEswdrVWjD6FpUIyszRRbe0jJ3KhQYMCkra6ibbPwgbI6UCvoiRMPT21xhY4w_itzlqnWZQD3y6jZqCMfSFQ6Gu1iLHeqhw4ZZRj3RjJ_-A>
	Jan 23
Technical Approach to "Everything is Content"
</group/sakai-kernel/web/technical-approach-to-everything-is-content?hl=en>
	Jan 23

		

K2 Deploying To Tomcat   	  Edit
</group/sakai-kernel/edit/k2-deploying-to-tomcat?hl=en>

		

This page describes how to deploy the K2 Agnostic POC to tomcat.



    Deployment to Tomcat


In K2 like in K1 we have started to use the Maven assembly plugin to
create an zip file that can be overlayed ontop of a tomcat instance.
This simplifies the build process by using standard maven plugins and
makes it possible to create a binary image of the sakai specific parts.
In the core kernel there is an overlay project that builds a zip file of
a binary image of the kernel.

 

There is a bootstrap project that will perform this operation for you
and give you an easy starting point for tomcat, but if you want to do it
manually, here is how.



Here is the current content of the overlay:


dhcp-92:~/Caret/sakai22/apache-tomcat-5.5.26 ieb$ unzip -l
../sakaidev/k2experiments/agnostic/overlay/target/assembly-0.1-SNAPSHOT-kernel-loader.zip

Archive: 
../sakaidev/k2experiments/agnostic/overlay/target/assembly-0.1-SNAPSHOT-kernel-loader.zip
  Length     Date   Time    Name
 --------    ----   ----    ----
        0  10-31-08 09:10   server/
        0  10-31-08 09:10   server/lib/
    16234  10-31-08 09:10   server/lib/server-0.1-SNAPSHOT.jar
        0  10-31-08 09:10   common/
        0  10-31-08 09:10   common/lib/
    10596  10-31-08 09:10   common/lib/common-0.1-SNAPSHOT.jar
    38015  05-15-07 21:59   common/lib/commons-logging-1.0.4.jar
   358085  05-15-07 22:40   common/lib/log4j-1.2.12.jar
        0  10-31-08 09:10   shared/
        0  10-31-08 09:10   shared/lib/
    64697  10-31-08 09:10   shared/lib/shared-0.1-SNAPSHOT.jar
   556135  04-03-08 11:09   shared/lib/guice-1.0.jar
   373194  05-08-08 12:48   shared/lib/xstream-1.2.2.jar
    24677  05-15-07 22:08   shared/lib/xpp3_min-1.1.3.4.O.jar
    93395  05-08-08 12:48   shared/lib/xpp3-1.1.3.3.jar
        0  10-15-08 14:23   conf/
     2179  10-15-08 14:23   conf/server.xml
 --------                   -------
  1537207                   17 files

dhcp-92:~/Caret/sakai22/apache-tomcat-5.5.26 ieb$ 


Notice the small number of shared libraries required to get the core
kernel up.


Now to deploy it.

   1. Unpack tomcat
   2. Unpack the overlay
   3. run tomcat

eg


dhcp-92:~/Caret/sakai22 ieb$ tar xzf tars/apache-tomcat-5.5.26.tar.gz
dhcp-92:~/Caret/sakai22 ieb$ cd apache-tomcat-5.5.26/
dhcp-92:~/Caret/sakai22/apache-tomcat-5.5.26 ieb$ unzip
../sakaidev/k2experiments/agnostic/overlay/target/assembly-0.1-SNAPSHOT-kernel-loader.zip

Archive: 
../sakaidev/k2experiments/agnostic/overlay/target/assembly-0.1-SNAPSHOT-kernel-loader.zip
  inflating: server/lib/server-0.1-SNAPSHOT.jar 
  inflating: common/lib/common-0.1-SNAPSHOT.jar 
  inflating: shared/lib/shared-0.1-SNAPSHOT.jar 
  inflating: shared/lib/guice-1.0.jar 
  inflating: shared/lib/xstream-1.2.2.jar 
  inflating: shared/lib/xpp3_min-1.1.3.4.O.jar 
  inflating: shared/lib/xpp3-1.1.3.3.jar 
replace conf/server.xml? [y]es, [n]o, [A]ll, [N]one, [r]ename: y
  inflating: conf/server.xml        
dhcp-92:~/Caret/sakai22/apache-tomcat-5.5.26 ieb$ bin/catalina.sh run
Using CATALINA_BASE:   /Users/ieb/Caret/sakai22/apache-tomcat-5.5.26
Using CATALINA_HOME:   /Users/ieb/Caret/sakai22/apache-tomcat-5.5.26
Using CATALINA_TMPDIR: /Users/ieb/Caret/sakai22/apache-tomcat-5.5.26/temp
Using JRE_HOME:       /Library/Java/Home
Oct 31, 2008 12:17:13 AM org.apache.catalina.core.AprLifecycleListener
lifecycleEvent
INFO: The Apache Tomcat Native library which allows optimal performance
in production environments was not found on the java.library.path:
.:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java
Oct 31, 2008 12:17:13 AM org.apache.coyote.http11.Http11BaseProtocol init
INFO: Initializing Coyote HTTP/1.1 on http-0
Oct 31, 2008 12:17:13 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 522 ms
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.tomcat5.KernelLoader start
WARNING: Got service as StandardService[Catalina]
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.tomcat5.KernelLoader start
WARNING: Got engine as StandardEngine[Catalina] with classloader
org.apache.catalina.loader.StandardClassLoader@2a5330 and with parent
classloader org.apache.catalina.loader.StandardClassLoader@c26c8f
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.LoaderEnvironment getLifecyleClass
WARNING: No Kernel Lifecycle Properties loaded null
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.LoaderEnvironment getLifecyleClass
INFO: Loading org.sakaiproject.kernel.component.KernelLifecycle using
org.apache.catalina.loader.StandardClassLoader@c26c8f
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.LoaderEnvironment getLifecyleClass
INFO: Loaded Ok
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.loader.server.tomcat5.KernelLoader start
INFO: Starting Component Lifecyle
org.sakaiproject.kernel.component.KernelLifecycle
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.component.KernelLifecycle start
INFO: Component Lifecycle is starting
==============================================
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.component.ComponentManagerImpl start
INFO: Starting Component Manager
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.component.ComponentManagerImpl startComponent
INFO: Activating
org.sakaiproject.kernel.component.core.KernelBootstrapSpec@4c94e5 with
Class org.sakaiproject.kernel.component.core.KernelBootstrapActivator
Oct 31, 2008 12:17:13 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Starting Shared Container
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded class
org.sakaiproject.kernel.component.core.KernelInjectorService as
org.sakaiproject.kernel.component.core.KernelInjectorService@e130c
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded class
org.sakaiproject.kernel.component.core.SharedClassLoaderContainer as
org.sakaiproject.kernel.component.core.SharedClassLoaderContainer@4a681
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded interface org.sakaiproject.kernel.api.ShutdownService as
org.sakaiproject.kernel.component.core.ShutdownServiceImpl@4f7537
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded interface
org.sakaiproject.kernel.api.PackageRegistryService as
org.sakaiproject.kernel.component.core.PackageRegistryServiceImpl@988dd6
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded interface
org.sakaiproject.kernel.api.DependencyResolverService as
org.sakaiproject.kernel.component.core.Maven2DependencyResolver@8806f7
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded interface org.sakaiproject.kernel.api.ClassLoaderService as
org.sakaiproject.kernel.component.core.ClassLoaderServiceImpl@dd40f3
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Loaded interface
org.sakaiproject.kernel.api.ComponentLoaderService as
org.sakaiproject.kernel.component.core.ComponentLoaderServiceImpl@d98b00
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd class
org.sakaiproject.kernel.component.core.SharedClassLoaderContainer as
org.sakaiproject.kernel.component.core.SharedClassLoaderContainer@4a681
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd interface org.sakaiproject.kernel.api.ShutdownService as
org.sakaiproject.kernel.component.core.ShutdownServiceImpl@4f7537
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd interface
org.sakaiproject.kernel.api.PackageRegistryService as
org.sakaiproject.kernel.component.core.PackageRegistryServiceImpl@988dd6
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd interface
org.sakaiproject.kernel.api.DependencyResolverService as
org.sakaiproject.kernel.component.core.Maven2DependencyResolver@8806f7
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd interface org.sakaiproject.kernel.api.ClassLoaderService
as org.sakaiproject.kernel.component.core.ClassLoaderServiceImpl@dd40f3
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.core.KernelBootstrapActivator activate
INFO: Registerd interface
org.sakaiproject.kernel.api.ComponentLoaderService as
org.sakaiproject.kernel.component.core.ComponentLoaderServiceImpl@d98b00
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.KernelLifecycle start
INFO: Memory Stats after startup
        Permgen Used 4 MB
        Code Cache Used 1 MB
        Eden Used 0 MB
        Tenured Used 1 MB
        Survivour Used 0 MB
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.component.KernelLifecycle start
INFO: Kernel Lifecycle Start Complete
===========================================
Oct 31, 2008 12:17:14 AM org.apache.catalina.realm.JAASRealm setContainer
INFO: Set JAAS app name Catalina
Oct 31, 2008 12:17:14 AM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Oct 31, 2008 12:17:14 AM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/5.5.26
Oct 31, 2008 12:17:14 AM org.apache.catalina.core.StandardHost start
INFO: XML validation disabled
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/host-manager]
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/manager]
Oct 31, 2008 12:17:14 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/balancer]
Oct 31, 2008 12:17:15 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/jsp-examples]
Oct 31, 2008 12:17:15 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO: StandardEngine[Catalina].StandardHost[localhost].StandardContext[]
Oct 31, 2008 12:17:15 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/servlets-examples]
Oct 31, 2008 12:17:15 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/tomcat-docs]
Oct 31, 2008 12:17:15 AM
org.sakaiproject.kernel.loader.server.tomcat5.SakaiContextConfig
lifecycleEvent
INFO:
StandardEngine[Catalina].StandardHost[localhost].StandardContext[/webdav]
Oct 31, 2008 12:17:15 AM org.apache.coyote.http11.Http11BaseProtocol start
INFO: Starting Coyote HTTP/1.1 on http-0
Oct 31, 2008 12:17:15 AM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Oct 31, 2008 12:17:15 AM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/15  config=null
Oct 31, 2008 12:17:15 AM org.apache.catalina.storeconfig.StoreLoader load
INFO: Find registry server-registry.xml at classpath resource
Oct 31, 2008 12:17:15 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1681 ms


So thats up, 1.6s. However this is just the kernel and the bootstrap
components with no real sakai implementation. It just probides the
following services.


SharedClassLoaderContainer, ShutdownService, PackageRegistryService,
DependencyResolverService, ComponentLoaderService, ComponentManager,
ServiceManager

 

The next step is to tell the ComponentLoaderService about other
components that need to be started.

 


      Kernel Configuration


The kernel is configured using two properties files. loader.properties
that defines the loading mechanism, and kernel.properties that defines
the properties injected into the kernel bootstrap component.


        Loader Properties


The loader properties only specifies the lifecycle class that is used to
bring up the kernel. This defaults to
org.sakaiproject.kernel.component.KernelLifecycle and should rarely need
to be changed. If however you want to change it you have three choices.

   1. Add a loader.properties into the server classloader classpath
      setting sakai.kernel.lifecycle to the new class
   2. Set the shell environment variable SAKAI_KERNEL_LIFECYCLE to the
      new class.
   3. Set the system property sakai.kernel.lifecycle to the new class.

Note that 3 takes precidence over 2 which takes precidence over 1. The
class must implement the CommonLifecycle interface.


        Kernel Properties

Kernel properties are slight more extensive and control the properties
inside the core kernel, there is a default set of properties


# specify a list of ComponentSpecification locations (ResourceLoader
style) separated by ; that

# either point to component xml files or if start with class: are
classes. These are 

# the list of components loaded in the bootstrap phase of the kernel
starting up.

components=class:org.sakaiproject.kernel.component.core.KernelBootstrapSpec

 

# A list of locations (seperated by ;) to search for components (on
disk) where component jars 

# may be found. These can point to jar files directly, or to
directories. If directories they 

# will be searched for jar files, and considered as classpath entries in
their own right.

# You could for example point to the maven generated target/classes
directroy of a project under

# development
component.locations=k2components 



These may be overridden by specifiying a resource location in the
ResourceLoader format. This is done by 

   1. Setting the shell environment property SAKAI_KERNEL_PROPERTIES to
      a resource location
   2. Setting the system property sakai.kernel.properties to a resource
      location


These locations point to a standard properties file, the values in this
file will be merged with the default set overwritting any existing
properties. Again 2 takes precidence over 1.


        Resource Loader format

Inside the kernel there is a ResourceLoader class that understands
resources referenced in URL fashion. 

Locations starting with 

    * res:// are resolved in the classpath (eg res://kernel.properties )
    * inline:// contain the properties themselves (eg inline://debug=true )
    * any other URL is passed to the URL class
    * any thing else is assumed to be a file

To Be Continued......

	Version: 

Page editing not supported in your web browser. Download a new copy of
Firefox <http://getfirefox.com> or Internet Explorer
<http://www.microsoft.com/windows/ie/downloads/> to edit pages.
*1 message about this page *
*Oct 30 2008* by Ian Boston
A short document on how to bring the core kernel up in tomcat...
worked first time ! The value of unit tests.

Click on
http://groups.google.com/group/sakai-kernel/web/k2-deploying-to-tomcat
- or copy & paste it into your browser's address bar if that doesn't
work.

Report this page
</groups/abuse?hl=en&group=sakai-kernel&type=page&url=http%3A%2F%2Fgroups.google.com%2Fgroup%2Fsakai-kernel%2Fweb%2Fk2-deploying-to-tomcat%3Fhl%3Den&_done=%2Fgroup%2Fsakai-kernel%2Fweb%2Fk2-deploying-to-tomcat%3Fhl%3Den%26&>

Reply to this discussion <#>
Hide message box <#>

	

*Create a group </groups/create?hl=en&lnk=gcf>* - Google Groups
</?hl=en> - Google Home <http://www.google.com/webhp?hl=en> - Terms of
Service
<http://groups.google.com/intl/en/googlegroups/terms_of_service3.html> -
Privacy Policy
<http://groups.google.com/intl/en/googlegroups/privacy3.html>
©2009 Google

